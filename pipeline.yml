resources:
- name: generator-scripts-repo
  type: git
  source:
    uri: git@git-server:/git-server/repos/generator_scripts.git
    branch: main
    depth: 1
    private_key: ((private_key))
  check_every: 10s




- name: empty-apps
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: app_(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c2s01-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c2s01-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c2s02-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c2s02-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c2s03-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c2s03-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c2s04-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c2s04-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c2s05-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c2s05-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c2s06-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c2s06-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c4s01-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c4s01-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c4s02-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c4s02-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c4s03-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c4s03-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c5s07-1-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c5s07-1-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c5s07-2-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c5s07-2-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c5s07-3-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c5s07-3-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c5s08-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c5s08-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c5s09-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c5s09-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c6s01-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c6s01-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c6s02-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c6s02-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c6s03-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c6s03-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c6s04-1-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c6s04-1-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c6s04-2a-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c6s04-2a-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c6s04-2b-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c6s04-2b-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c7s01-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c7s01-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c7s02-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c7s02-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))
- name: c7s03-code
  type: s3
  source:
    endpoint: ((s3_endpoint))
    bucket: ((s3_bucket))
    regexp: c7s03-(.*)\.tgz
    access_key_id: ((aws_key))
    secret_access_key: ((aws_secret))





jobs:
- name: generate-empty-app
  plan:
  - get: generator-scripts-repo
  - task: generate-empty-app
    file: generator-scripts-repo/generator_scripts/ci/generate-code.yml
    output_mapping:
      code_output: empty-apps
  - put: empty-apps
    params:
      file: "empty-apps/*.tgz"
      acl: public-read




- name: c2s01
  plan:
  - get: generator-scripts-repo
  - get: empty-apps
  - task: c2s01-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: empty-apps
    output_mapping:
      code_output: c2s01-code
    params:
      PREV_CHAPTER: app
      CHAPTER: c2s01
  - put: c2s01-code
    params:
      file: "c2s01-code/c2s01-*.tgz"
      acl: public-read

- name: c2s01-test
  plan:
  - get: generator-scripts-repo
  - get: c2s01-code
    passed: [c2s01]
    trigger: true
  - task: c2s01-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c2s01-code
    params:
      CHAPTER: c2s01
      PACKWERK_CHECK: true




- name: c2s02
  plan:
  - get: generator-scripts-repo
  - get: c2s01-code
    passed: [c2s01]
    trigger: true
  - task: c2s02-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c2s01-code
    output_mapping:
      code_output: c2s02-code
    params:
      PREV_CHAPTER: c2s01
      CHAPTER: c2s02
  - put: c2s02-code
    params:
      file: "c2s02-code/c2s02-*.tgz"
      acl: public-read

- name: c2s02-test
  plan:
  - get: generator-scripts-repo
  - get: c2s02-code
    passed: [c2s02]
    trigger: true
  - task: c2s02-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c2s02-code
    params:
      CHAPTER: c2s02
      PACKWERK_CHECK: true




- name: c2s03
  plan:
  - get: generator-scripts-repo
  - get: c2s02-code
    passed: [c2s02]
    trigger: true
  - task: c2s03-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c2s02-code
    output_mapping:
      code_output: c2s03-code
    params:
      PREV_CHAPTER: c2s02
      CHAPTER: c2s03
  - put: c2s03-code
    params:
      file: "c2s03-code/c2s03-*.tgz"
      acl: public-read

- name: c2s03-test
  plan:
  - get: generator-scripts-repo
  - get: c2s03-code
    passed: [c2s03]
    trigger: true
  - task: c2s03-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c2s03-code
    params:
      CHAPTER: c2s03
      PACKWERK_CHECK: true



- name: c2s04
  plan:
  - get: generator-scripts-repo
  - get: c2s03-code
    passed: [c2s03]
    trigger: true
  - task: c2s04-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c2s03-code
    output_mapping:
      code_output: c2s04-code
    params:
      PREV_CHAPTER: c2s03
      CHAPTER: c2s04
  - put: c2s04-code
    params:
      file: "c2s04-code/c2s04-*.tgz"
      acl: public-read

- name: c2s04-test
  plan:
  - get: generator-scripts-repo
  - get: c2s04-code
    passed: [c2s04]
    trigger: true
  - task: c2s04-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c2s04-code
    params:
      CHAPTER: c2s04
      PACKWERK_CHECK: true




- name: c2s05
  plan:
  - get: generator-scripts-repo
  - get: c2s04-code
    passed: [c2s04]
    trigger: true
  - task: c2s05-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c2s04-code
    output_mapping:
      code_output: c2s05-code
    params:
      PREV_CHAPTER: c2s04
      CHAPTER: c2s05
  - put: c2s05-code
    params:
      file: "c2s05-code/c2s05-*.tgz"
      acl: public-read

- name: c2s05-test
  plan:
  - get: generator-scripts-repo
  - get: c2s05-code
    passed: [c2s05]
    trigger: true
  - task: c2s05-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c2s05-code
    params:
      CHAPTER: c2s05
      PACKWERK_CHECK: true




- name: c2s06
  plan:
  - get: generator-scripts-repo
  - get: c2s05-code
    passed: [c2s05]
    trigger: true
  - task: c2s06-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c2s05-code
    output_mapping:
      code_output: c2s06-code
    params:
      PREV_CHAPTER: c2s05
      CHAPTER: c2s06
  - put: c2s06-code
    params:
      file: "c2s06-code/c2s06-*.tgz"
      acl: public-read

- name: c2s06-test
  plan:
  - get: generator-scripts-repo
  - get: c2s06-code
    passed: [c2s06]
    trigger: true
  - task: c2s06-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c2s06-code
    params:
      CHAPTER: c2s06
      PACKWERK_CHECK: true




- name: c4s01
  plan:
  - get: generator-scripts-repo
  - get: c2s06-code
    passed: [c2s06]
    trigger: true
  - task: c4s01-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c2s06-code
    output_mapping:
      code_output: c4s01-code
    params:
      PREV_CHAPTER: c2s06
      CHAPTER: c4s01
  - put: c4s01-code
    params:
      file: "c4s01-code/c4s01-*.tgz"
      acl: public-read

- name: c4s01-test
  plan:
  - get: generator-scripts-repo
  - get: c4s01-code
    passed: [c4s01]
    trigger: true
  - task: c4s01-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c4s01-code
    params:
      CHAPTER: c4s01
      PACKWERK_CHECK: true




- name: c4s02
  plan:
  - get: generator-scripts-repo
  - get: c2s06-code
    passed: [c2s06]
    trigger: true
  - task: c4s02-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c2s06-code
    output_mapping:
      code_output: c4s02-code
    params:
      PREV_CHAPTER: c2s06
      CHAPTER: c4s02
  - put: c4s02-code
    params:
      file: "c4s02-code/c4s02-*.tgz"
      acl: public-read

- name: c4s02-test
  plan:
  - get: generator-scripts-repo
  - get: c4s02-code
    passed: [c4s02]
    trigger: true
  - task: c4s02-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c4s02-code
    params:
      CHAPTER: c4s02
      PACKWERK_CHECK: true




- name: c4s03
  plan:
  - get: generator-scripts-repo
  - get: c4s02-code
    passed: [c4s02]
    trigger: true
  - task: c4s03-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c4s02-code
    output_mapping:
      code_output: c4s03-code
    params:
      PREV_CHAPTER: c4s02
      CHAPTER: c4s03
  - put: c4s03-code
    params:
      file: "c4s03-code/c4s03-*.tgz"
      acl: public-read

- name: c4s03-test
  plan:
  - get: generator-scripts-repo
  - get: c4s03-code
    passed: [c4s03]
    trigger: true
  - task: c4s03-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c4s03-code
    params:
      CHAPTER: c4s03
      PACKWERK_CHECK: true



- name: c5s07-1
  plan:
  - get: generator-scripts-repo
    trigger: false
  - get: c2s06-code
    passed: [c2s06]
    trigger: true
  - task: c5s07-1-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c2s06-code
    output_mapping:
      code_output: c5s07-1-code
    params:
      PREV_CHAPTER: c2s06
      CHAPTER: c5s07-1
  - put: c5s07-1-code
    params:
      file: "c5s07-1-code/c5s07-1-*.tgz"
      acl: public-read

- name: c5s07-1-test
  plan:
  - get: generator-scripts-repo
  - get: c5s07-1-code
    passed: [c5s07-1]
    trigger: true
  - task: c5s07-1-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c5s07-1-code
    params:
      CHAPTER: c5s07-1
      PACKWERK_CHECK: true




- name: c5s07-2
  plan:
  - get: generator-scripts-repo
    trigger: false
  - get: c5s07-1-code
    passed: [c5s07-1]
    trigger: true
  - task: c5s07-2-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c5s07-1-code
    output_mapping:
      code_output: c5s07-2-code
    params:
      PREV_CHAPTER: c5s07-1
      CHAPTER: c5s07-2
  - put: c5s07-2-code
    params:
      file: "c5s07-2-code/c5s07-2-*.tgz"
      acl: public-read

- name: c5s07-2-test
  plan:
  - get: generator-scripts-repo
  - get: c5s07-2-code
    passed: [c5s07-2]
    trigger: true
  - task: c5s07-2-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c5s07-2-code
    params:
      CHAPTER: c5s07-2
      PACKWERK_CHECK: true
      # SORBET: true




- name: c5s07-3
  plan:
  - get: generator-scripts-repo
    trigger: false
  - get: c5s07-2-code
    passed: [c5s07-2]
    trigger: true
  - task: c5s07-3-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c5s07-2-code
    output_mapping:
      code_output: c5s07-3-code
    params:
      PREV_CHAPTER: c5s07-2
      CHAPTER: c5s07-3
  - put: c5s07-3-code
    params:
      file: "c5s07-3-code/c5s07-3-*.tgz"
      acl: public-read

- name: c5s07-3-test
  plan:
  - get: generator-scripts-repo
  - get: c5s07-3-code
    passed: [c5s07-3]
    trigger: true
  - task: c5s07-3-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c5s07-3-code
    params:
      CHAPTER: c5s07-3
      PACKWERK_CHECK: true
      # SORBET: true



- name: c5s08
  plan:
  - get: generator-scripts-repo
  - get: c5s07-3-code
    passed: [c5s07-3]
    trigger: true
  - task: c5s08-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c5s07-3-code
    output_mapping:
      code_output: c5s08-code
    params:
      PREV_CHAPTER: c5s07-3
      CHAPTER: c5s08
  - put: c5s08-code
    params:
      file: "c5s08-code/c5s08-*.tgz"
      acl: public-read

- name: c5s08-test
  plan:
  - get: generator-scripts-repo
  - get: c5s08-code
    passed: [c5s08]
    trigger: true
  - task: c5s08-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c5s08-code
    params:
      CHAPTER: c5s08
      PACKWERK_CHECK: true




- name: c5s09
  plan:
  - get: generator-scripts-repo
  - get: c5s08-code
    passed: [c5s08]
    trigger: true
  - task: c5s09-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c5s08-code
    output_mapping:
      code_output: c5s09-code
    params:
      PREV_CHAPTER: c5s08
      CHAPTER: c5s09
  - put: c5s09-code
    params:
      file: "c5s09-code/c5s09-*.tgz"
      acl: public-read

- name: c5s09-test
  plan:
  - get: generator-scripts-repo
  - get: c5s09-code
    passed: [c5s09]
    trigger: true
  - task: c5s09-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c5s09-code
    params:
      CHAPTER: c5s09
      PACKWERK_CHECK: true




- name: c6s01
  plan:
  - get: generator-scripts-repo
    trigger: false
  - get: c5s07-3-code
    passed: [c5s07-3]
    trigger: true
  - task: c6s01-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c5s07-3-code
    output_mapping:
      code_output: c6s01-code
    params:
      PREV_CHAPTER: c5s07-3
      CHAPTER: c6s01
  - put: c6s01-code
    params:
      file: "c6s01-code/c6s01-*.tgz"
      acl: public-read

- name: c6s01-test
  plan:
  - get: generator-scripts-repo
  - get: c6s01-code
    passed: [c6s01]
    trigger: true
  - task: c6s01-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c6s01-code
    params:
      CHAPTER: c6s01
      PACKWERK_CHECK: true
      # SORBET: true

- name: c6s02
  plan:
  - get: generator-scripts-repo
    trigger: false
  - get: c6s01-code
    passed: [c6s01]
    trigger: true
  - task: c6s02-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c6s01-code
    output_mapping:
      code_output: c6s02-code
    params:
      PREV_CHAPTER: c6s01
      CHAPTER: c6s02
  - put: c6s02-code
    params:
      file: "c6s02-code/c6s02-*.tgz"
      acl: public-read

- name: c6s02-test
  plan:
  - get: generator-scripts-repo
  - get: c6s02-code
    passed: [c6s02]
    trigger: true
  - task: c6s02-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c6s02-code
    params:
      CHAPTER: c6s02
      PACKWERK_CHECK: true
      # SORBET: true

- name: c6s03
  plan:
  - get: generator-scripts-repo
    trigger: false
  - get: c6s02-code
    passed: [c6s02]
    trigger: true
  - task: c6s03-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c6s02-code
    output_mapping:
      code_output: c6s03-code
    params:
      PREV_CHAPTER: c6s02
      CHAPTER: c6s03
  - put: c6s03-code
    params:
      file: "c6s03-code/c6s03-*.tgz"
      acl: public-read

- name: c6s03-test
  plan:
  - get: generator-scripts-repo
  - get: c6s03-code
    passed: [c6s03]
    trigger: true
  - task: c6s03-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c6s03-code
    params:
      CHAPTER: c6s03
      PACKWERK_CHECK: true
      # SORBET: true

- name: c6s04-1
  plan:
  - get: generator-scripts-repo
    trigger: false
  - get: c6s03-code
    passed: [c6s03]
    trigger: true
  - task: c6s04-1-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c6s03-code
    output_mapping:
      code_output: c6s04-1-code
    params:
      PREV_CHAPTER: c6s03
      CHAPTER: c6s04-1
  - put: c6s04-1-code
    params:
      file: "c6s04-1-code/c6s04-1-*.tgz"
      acl: public-read

- name: c6s04-1-test
  plan:
  - get: generator-scripts-repo
  - get: c6s04-1-code
    passed: [c6s04-1]
    trigger: true
  - task: c6s04-1-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c6s04-1-code
    params:
      CHAPTER: c6s04-1
      PACKWERK_CHECK: true
      # SORBET: true

- name: c6s04-2a
  plan:
  - get: generator-scripts-repo
    trigger: false
  - get: c6s03-code
    passed: [c6s03]
    trigger: true
  - task: c6s04-2a-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c6s03-code
    output_mapping:
      code_output: c6s04-2a-code
    params:
      PREV_CHAPTER: c6s03
      CHAPTER: c6s04-2a
  - put: c6s04-2a-code
    params:
      file: "c6s04-2a-code/c6s04-2a-*.tgz"
      acl: public-read

- name: c6s04-2a-test
  plan:
  - get: generator-scripts-repo
  - get: c6s04-2a-code
    passed: [c6s04-2a]
    trigger: true
  - task: c6s04-2a-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c6s04-2a-code
    params:
      CHAPTER: c6s04-2a
      PACKWERK_CHECK: true
      # SORBET: true

- name: c6s04-2b
  plan:
  - get: generator-scripts-repo
    trigger: false
  - get: c6s04-2a-code
    passed: [c6s04-2a]
    trigger: true
  - task: c6s04-2b-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c6s04-2a-code
    output_mapping:
      code_output: c6s04-2b-code
    params:
      PREV_CHAPTER: c6s04-2a
      CHAPTER: c6s04-2b
  - put: c6s04-2b-code
    params:
      file: "c6s04-2b-code/c6s04-2b-*.tgz"
      acl: public-read

- name: c6s04-2b-test
  plan:
  - get: generator-scripts-repo
  - get: c6s04-2b-code
    passed: [c6s04-2b]
    trigger: true
  - task: c6s04-2b-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c6s04-2b-code
    params:
      CHAPTER: c6s04-2b
      PACKWERK_CHECK: true
      # SORBET: true




- name: c7s01
  plan:
  - get: generator-scripts-repo
    trigger: false
  - get: c2s06-code
    # passed: [c2s06]
    trigger: true
  - task: c7s01-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c2s06-code
    output_mapping:
      code_output: c7s01-code
    params:
      PREV_CHAPTER: c2s06
      CHAPTER: c7s01
  - put: c7s01-code
    params:
      file: "c7s01-code/c7s01-*.tgz"
      acl: public-read

- name: c7s01-test
  plan:
  - get: generator-scripts-repo
  - get: c7s01-code
    passed: [c7s01]
    trigger: true
  - task: c7s01-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c7s01-code
    params:
      CHAPTER: c7s01
      PACKWERK_CHECK: true
      # SORBET: true
- name: c7s02
  plan:
  - get: generator-scripts-repo
    trigger: false
  - get: c7s01-code
    passed: [c7s01]
    trigger: true
  - task: c7s02-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c7s01-code
    output_mapping:
      code_output: c7s02-code
    params:
      PREV_CHAPTER: c7s01
      CHAPTER: c7s02
  - put: c7s02-code
    params:
      file: "c7s02-code/c7s02-*.tgz"
      acl: public-read

- name: c7s02-test
  plan:
  - get: generator-scripts-repo
  - get: c7s02-code
    passed: [c7s02]
    trigger: true
  - task: c7s02-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c7s02-code
    params:
      CHAPTER: c7s02
      PACKWERK_CHECK: true
      SORBET: true

- name: c7s03
  plan:
  - get: generator-scripts-repo
    trigger: false
  - get: c7s02-code
    passed: [c7s02]
    trigger: true
  - task: c7s03-task
    file: generator-scripts-repo/generator_scripts/ci/transform-code.yml
    input_mapping:
      code_input: c7s02-code
    output_mapping:
      code_output: c7s03-code
    params:
      PREV_CHAPTER: c7s02
      CHAPTER: c7s03
  - put: c7s03-code
    params:
      file: "c7s03-code/c7s03-*.tgz"
      acl: public-read

- name: c7s03-test
  plan:
  - get: generator-scripts-repo
  - get: c7s03-code
    passed: [c7s03]
    trigger: true
  - task: c7s03-test-task
    file: generator-scripts-repo/generator_scripts/ci/run-tests.yml
    input_mapping:
      app_code: c7s03-code
    params:
      CHAPTER: c7s03
      PACKWERK_CHECK: true
      SORBET: true
